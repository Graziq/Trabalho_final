name: Check Prefect Flow Quality

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build_and_test: # Nome do job
    runs-on: windows-latest # O job serÃ¡ executado em um runner Windows

    steps: # SequÃªncia de passos
      - name: ğŸ” Checkout do cÃ³digo # Passo para baixar seu cÃ³digo
        uses: actions/checkout@v3

      - name: ğŸ Instalar Python 3.10 # Passo para configurar o ambiente Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      - name: ğŸ“¦ Instalar dependÃªncias # Instala as bibliotecas Python necessÃ¡rias
        run: |
          python -m pip install -U pip
          python -m pip install -r requirements.txt
          python -m pip install "prefect==2.16.4"
          # Instale ferramentas de linting e teste, se ainda nÃ£o estiverem no requirements.txt
          python -m pip install flake8 pytest # Exemplo: Flake8 para linting, Pytest para testes
          
          # Configura PYTHONPATH para Windows (PowerShell)
          # Isso Ã© crucial para que o Prefect encontre os mÃ³dulos dentro de 'src'
          $env:PYTHONPATH="$env:PYTHONPATH;$(Get-Location)\src"
        shell: powershell

      - name: ğŸ” Rodar Linting (Flake8) # Passo opcional: Verifica padrÃµes de cÃ³digo
        # garante que o cÃ³digo siga as boas prÃ¡ticas e padrÃµes de estilo.
        run: |
          # Altere o caminho 'src' se seus arquivos Python estiverem em outro lugar
          flake8 src
        shell: powershell
        continue-on-error: true # Permite que o workflow continue mesmo se o linting encontrar avisos/erros

      - name: ğŸ§ª Rodar Testes UnitÃ¡rios/IntegraÃ§Ã£o
        run: |
          # pytest tests/ # Exemplo de comando pytest
          Write-Host "Nenhum teste unitÃ¡rio configurado neste exemplo. Adicione seus comandos de teste aqui."
        shell: powershell